<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<title>ğŸ„ Christmas Control</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0" />

<style>
body {
  margin: 0;
  height: 100vh;
  background: radial-gradient(circle at top, #0b3d2e, #021b12);
  display: flex;
  justify-content: center;
  align-items: center;
  font-family: system-ui;
  color: white;
}

/* â„ï¸ SNOW */
body::before {
  content: "";
  position: fixed;
  inset: 0;
  background-image:
    radial-gradient(2px 2px at 20% 30%, white 40%, transparent 41%),
    radial-gradient(2px 2px at 70% 60%, white 40%, transparent 41%),
    radial-gradient(1.5px 1.5px at 40% 80%, white 40%, transparent 41%);
  opacity: 0.6;
  pointer-events: none;
}

/* ğŸ„ PANEL */
.panel {
  background: rgba(0,0,0,0.55);
  padding: 40px 30px;
  border-radius: 28px;
  text-align: center;
  box-shadow: 0 30px 80px rgba(0,0,0,0.9);
}

h1 {
  margin: 0 0 10px;
  font-size: 2rem;
}

.subtitle {
  opacity: 0.8;
  margin-bottom: 30px;
}

/* ğŸ BUTTON */
.toggle {
  width: 160px;
  height: 160px;
  border-radius: 50%;
  border: none;
  font-size: 1.5rem;
  font-weight: bold;
  cursor: pointer;
  background: radial-gradient(circle at top, #555, #111);
  color: white;
  transition: 0.4s ease;
}

.toggle.on {
  background: radial-gradient(circle at top, #00ff88, #007744);
  box-shadow:
    0 0 25px #00ff88,
    0 0 60px rgba(0,255,136,0.8);
  transform: scale(1.1);
}

/* ğŸ… STATUS */
.status {
  margin-top: 20px;
  font-size: 1.1rem;
}

.footer {
  margin-top: 10px;
  opacity: 0.7;
}
</style>
</head>

<body>

<div class="panel">
  <h1>ğŸ„ Christmas Tree</h1>
  <div class="subtitle">Holiday Power Control</div>

  <button id="toggleBtn" class="toggle">OFF</button>

  <div id="status" class="status">Checking statusâ€¦</div>
  <div id="footer" class="footer">â„ï¸ Ready</div>
</div>

<script>
const btn = document.getElementById("toggleBtn");
const statusText = document.getElementById("status");
const footer = document.getElementById("footer");

let isOn = false;

/* ğŸ”„ SYNC STATUS */
async function refreshStatus() {
  try {
    const res = await fetch("/status");
    const data = await res.json();

    isOn = data.kasa && data.tuya;
    updateUI();
    footer.textContent = "Status synced ğŸ„";
  } catch {
    footer.textContent = "Status error âŒ";
  }
}

/* ğŸ”˜ TOGGLE */
btn.onclick = async () => {
  try {
    isOn = !isOn;
    updateUI();

    await fetch("/toggle", {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify({ state: isOn })
    });

    footer.textContent = "Command sent ğŸ";
  } catch {
    footer.textContent = "Toggle failed âŒ";
  }
};

function updateUI() {
  btn.classList.toggle("on", isOn);
  btn.textContent = isOn ? "ON" : "OFF";
  statusText.textContent = isOn
    ? "âœ¨ Christmas Tree ON âœ¨"
    : "ğŸŒ™ Christmas Tree OFF";
}

refreshStatus();
</script>

</body>
</html>

